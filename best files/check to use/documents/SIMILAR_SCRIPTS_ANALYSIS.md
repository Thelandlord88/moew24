# Similar Scripts Analysis: Redirect/URL Testing Files

**Date**: September 17, 2025  
**Action**: Deleted `scripts/redirect-canary.mjs`  
**Next Task**: Review similar files for cleanup potential

---

## 🎯 Deleted Script Analysis

**File**: `scripts/redirect-canary.mjs`
**Purpose**: Manual redirect testing with hardcoded URL checks
**Pattern**: `BASE` + `PREVIEW_URL` + `fetch` with `redirect: manual`
**Characteristics**:
- Hardcoded test cases
- Manual HEAD requests
- Status code validation (301/302)
- Location header checking

---

## 🔍 Similar Files Found

### **Category 1: Manual Redirect Testing Scripts** ⚠️ **REVIEW CANDIDATES**

#### `scripts/validate-redirects.mjs`
- **Similarity**: High (same pattern as deleted script)
- **Purpose**: Validates redirects from `public/_redirects` file
- **Pattern**: `BASE` + `PREVIEW_URL` + manual URL testing
- **Status**: Active - may need review for duplication

#### `scripts/redirects-sample.mjs`
- **Similarity**: Medium (redirect-focused but different purpose)
- **Purpose**: Samples redirect rules for testing
- **Pattern**: Processes `public/_redirects` file
- **Status**: Utility script - likely needed

#### `scripts/serve-with-redirects.mjs`
- **Similarity**: Low (server, not testing)
- **Purpose**: Static server with redirect support
- **Pattern**: HTTP server implementation
- **Status**: Infrastructure - keep

### **Category 2: Automated Test Files** ✅ **PROPER TESTS**

#### `tests/synonym-redirects.canary.spec.ts`
- **Similarity**: High (canary testing pattern)
- **Purpose**: Playwright tests for synonym redirects
- **Pattern**: Automated test cases with assertions
- **Status**: Proper testing - keep

#### `tests/redirects.spec.ts`
- **Similarity**: Medium (redirect testing)
- **Purpose**: Automated redirect validation
- **Pattern**: Test framework integration
- **Status**: Proper testing - keep

#### `tests/e2e/synonym-redirects.spec.ts`
- **Similarity**: Medium (E2E redirect testing)
- **Purpose**: End-to-end redirect validation
- **Pattern**: Browser-based testing
- **Status**: Proper testing - keep

### **Category 3: Redirect Generation/Management** ✅ **KEEP**

#### `scripts/generate-synonym-redirects.mjs`
- **Similarity**: Low (generation, not testing)
- **Purpose**: Generates redirect rules
- **Pattern**: Creates `public/_redirects` content
- **Status**: Essential - keep

#### `scripts/verify-redirects-block.mjs`
- **Similarity**: Low (validation, not testing)
- **Purpose**: Verifies redirect block structure
- **Pattern**: Content validation
- **Status**: CI validation - keep

---

## 🚨 High Priority Review Candidates

### **1. `scripts/validate-redirects.mjs`** ⚠️ **REVIEW NEEDED**

**Reason for Review**:
- Very similar to deleted `redirect-canary.mjs`
- Uses same pattern: `BASE` + `PREVIEW_URL` + manual fetch
- May have overlapping functionality with automated tests

**Code Pattern**:
```javascript
const BASE = process.env.PREVIEW_URL || "http://localhost:4322";
// Manual URL testing with fetch
// Status code and location header validation
```

**Recommendation**: Check if this duplicates functionality in automated tests

### **2. Output Files in `__ai/`** 🗑️ **CLEANUP CANDIDATES**

**Files Found**:
- `__ai/redirects-check.txt`
- `__ai/redirects.txt` 
- `__ai/redirects-validate.txt`

**Reason**: Likely generated by deleted script or similar manual processes
**Recommendation**: Review and clean up stale output files

---

## 🔍 Analysis Questions

### **Functional Overlap Assessment**:

1. **Do we need both manual scripts AND automated tests?**
   - Manual: `scripts/validate-redirects.mjs`
   - Automated: `tests/synonym-redirects.canary.spec.ts`

2. **Are the hardcoded test cases in scripts redundant?**
   - Scripts use hardcoded URL pairs
   - Tests use systematic test case generation

3. **Is manual URL testing still needed?**
   - CI/CD has automated redirect testing
   - Playwright tests cover browser behavior

### **Maintenance Burden**:

1. **Hardcoded URLs require manual updates**
2. **Manual scripts need environment setup**
3. **Output files accumulate without cleanup**

---

## 🎯 Recommended Actions

### **Immediate Actions**:

1. **Review `scripts/validate-redirects.mjs`**:
   ```bash
   # Check if functionality overlaps with tests
   npm run test:redirects  # Compare with manual script
   ```

2. **Clean up output files**:
   ```bash
   # Remove stale redirect check files
   rm __ai/redirects-*.txt
   ```

3. **Audit npm scripts**:
   ```bash
   # Check if deleted script was referenced
   npm run | grep redirect
   ```

### **Assessment Workflow**:

1. **Compare Coverage**:
   - Map manual script test cases to automated tests
   - Identify gaps or redundancies

2. **Performance Check**:
   - Are manual scripts faster/slower than automated tests?
   - Do they provide unique value?

3. **CI Integration**:
   - Which approach integrates better with CI/CD?
   - Are manual scripts used in deployment validation?

---

## 📊 Classification Summary

| File | Type | Similarity | Action |
|------|------|------------|--------|
| `scripts/validate-redirects.mjs` | Manual Testing | High | 🔍 **Review** |
| `scripts/redirects-sample.mjs` | Utility | Medium | ✅ Keep |
| `scripts/serve-with-redirects.mjs` | Server | Low | ✅ Keep |
| `tests/synonym-redirects.canary.spec.ts` | Automated Test | High | ✅ Keep |
| `tests/redirects.spec.ts` | Automated Test | Medium | ✅ Keep |
| `scripts/generate-synonym-redirects.mjs` | Generator | Low | ✅ Keep |
| `scripts/verify-redirects-block.mjs` | Validator | Low | ✅ Keep |
| `__ai/redirects-*.txt` | Output Files | N/A | 🗑️ **Cleanup** |

---

## 🎯 Next Steps

1. **Priority 1**: Review `scripts/validate-redirects.mjs` for redundancy
2. **Priority 2**: Clean up stale output files in `__ai/`
3. **Priority 3**: Audit npm scripts for broken references
4. **Priority 4**: Consider consolidating manual testing approaches

**Goal**: Eliminate redundant manual testing scripts while preserving unique functionality and proper automated test coverage.

---

*Analysis complete. Ready for targeted cleanup of similar redirect testing scripts.*
