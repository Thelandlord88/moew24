---
import Header from '../components/Header.astro';

const { title = "One N Done Blog", description = "Bond cleaning tips, guides & checklists", canonical } = Astro.props;
const site = Astro.site?.origin ?? "https://onedone.com.au";
---

<!doctype html>
<html lang="en" class="h-full">
  <head>
    <meta charset="utf-8" />
    <title>{title}</title>
    <meta name="description" content={description} />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    {canonical ? <link rel="canonical" href={canonical} /> : null}
    <link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Blog RSS" />
    <meta name="color-scheme" content="light dark" />
    
    <!-- Analytics Shim - One Intercom for the House -->
    <script type="module">
      // Minimal analytics shim (no GA required)
      window.analytics = (t, props = {}) => {
        try {
          const payload = JSON.stringify({ 
            t, 
            ...props, 
            ts: Date.now(), 
            path: location.pathname, 
            ref: document.referrer 
          });
          if (navigator.sendBeacon) {
            navigator.sendBeacon('/api/e', new Blob([payload], { type: 'application/json' }));
          } else {
            fetch('/api/e', { 
              method: 'POST', 
              headers: { 'content-type': 'application/json' }, 
              body: payload, 
              keepalive: true 
            });
          }
        } catch {}
      };
    </script>
    <style is:global>
      @import "/src/styles/global.css";
    </style>
  </head>
  <body class="min-h-full bg-white text-slate-900 antialiased">
    <Header />

    <main class="mx-auto max-w-6xl px-4 py-10 pt-24">
      <slot />
    </main>

    <footer class="border-t">
      <div class="mx-auto max-w-6xl px-4 py-10 text-sm text-slate-500">
        <div>Â© {new Date().getFullYear()} One N Done Bond Clean</div>
        <div class="mt-2"><a class="underline" href="/blog/rss.xml">RSS</a></div>
      </div>
    </footer>
  </body>
</html>
